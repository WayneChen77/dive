"use strict";(self["webpackChunkDive"]=self["webpackChunkDive"]||[]).push([[723],{7064:function(e,t,a){a.d(t,{Z:function(){return v}});var l=a(3396),d=a(7139);const i={class:"modal fade",id:"delModal",tabindex:"-1",role:"dialog","aria-labelledby":"exampleModalLabel","aria-hidden":"true",ref:"modal"},n={class:"modal-dialog",role:"document"},s={class:"modal-content"},r=(0,l._)("div",{class:"modal-header bg-warning"},[(0,l._)("h1",{class:"modal-title fs-5",id:"exampleModalLabel"},"刪除品項"),(0,l._)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),o={class:"modal-body"},c={class:"modal-title",id:"exampleModalLabel"},u={key:0},p={key:1},h={key:0},_={key:1},g={key:2},m={class:"modal-footer"};function w(e,t,a,w,b,k){return(0,l.wg)(),(0,l.iD)("div",i,[(0,l._)("div",n,[(0,l._)("div",s,[r,(0,l._)("div",o,[(0,l._)("h5",c,[(0,l._)("p",null,[(0,l._)("span",null,(0,d.zw)(a.product.title),1),a.product.code?((0,l.wg)(),(0,l.iD)("span",u,"折扣碼:"+(0,d.zw)(a.product.code),1)):(0,l.kq)("",!0),a.product.price?((0,l.wg)(),(0,l.iD)("span",p,"$:"+(0,d.zw)(a.product.price),1)):(0,l.kq)("",!0)]),a.product.percent?((0,l.wg)(),(0,l.iD)("p",h,[(0,l.Uk)(" 折數"),(0,l._)("span",null,(0,d.zw)(a.product.percent),1)])):(0,l.kq)("",!0),a.product.due_date?((0,l.wg)(),(0,l.iD)("p",_,[(0,l.Uk)(" 到期日"),(0,l._)("span",null,(0,d.zw)(this.$filters.date(a.product.due_date)),1)])):(0,l.kq)("",!0),(0,l._)("p",null,"訂單編號:"+(0,d.zw)(a.product.id),1),a.product.user?((0,l.wg)(),(0,l.iD)("p",g,"客戶:"+(0,d.zw)(a.product.user.name),1)):(0,l.kq)("",!0)])]),(0,l._)("div",m,[(0,l._)("button",{type:"button",class:"btn btn-primary",onClick:t[0]||(t[0]=t=>e.$emit("del-item",a.product))}," 確認刪除 "),(0,l._)("button",{type:"button",class:"btn btn-secondary",onClick:t[1]||(t[1]=(...t)=>e.hideModal&&e.hideModal(...t))},"取消")])])])],512)}var b=a(3618),k={data(){return{modal:""}},props:{product:{type:Object},default(){return{}}},mixins:[b.Z]},y=a(89);const f=(0,y.Z)(k,[["render",w]]);var v=f},8636:function(e,t,a){a.d(t,{Z:function(){return b}});var l=a(3396),d=a(7139),i=a(9242);const n={"aria-label":"Page navigation example"},s={class:"pagination justify-content-center"},r=(0,l._)("a",{class:"page-link",href:" ","aria-label":"Previous"},[(0,l._)("span",{"aria-hidden":"true"},"«")],-1),o=[r],c=["onClick","onKeyup"],u={class:"page-link",href:"#"},p=(0,l._)("a",{class:"page-link",href:"","aria-label":"Next"},[(0,l._)("span",{"aria-hidden":"true"},"»")],-1),h=[p];function _(e,t,a,r,p,_){return(0,l.wg)(),(0,l.iD)("nav",n,[(0,l._)("ul",s,[(0,l._)("li",{class:(0,d.C_)(["page-item",{disabled:!a.pages.has_pre}]),onClick:t[0]||(t[0]=(0,i.iM)((e=>_.clickPagination(a.pages.current_page-1)),["prevent"])),onKeyup:t[1]||(t[1]=(0,i.D2)((e=>_.clickPagination(a.pages.current_page-1)),["enter"]))},o,34),((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(a.pages.total_pages,(e=>((0,l.wg)(),(0,l.iD)("li",{class:(0,d.C_)(["page-item",{active:a.pages.current_page===e}]),key:"pages"+e,onClick:(0,i.iM)((t=>_.clickPagination(e)),["prevent"]),onKeyup:(0,i.D2)((t=>_.clickPagination(e)),["enter"])},[(0,l._)("a",u,(0,d.zw)(e),1)],42,c)))),128)),(0,l._)("li",{class:(0,d.C_)(["page-item",{disabled:!a.pages.has_next}]),onClick:t[2]||(t[2]=(0,i.iM)((e=>_.clickPagination(a.pages.current_page+1)),["prevent"])),onKeyup:t[3]||(t[3]=(0,i.D2)((e=>_.clickPagination(a.pages.current_page+1)),["enter"]))},h,34)])])}var g={props:["pages"],methods:{updatePage(){},clickPagination(e){this.$emit("change-pagination",e)}}},m=a(89);const w=(0,m.Z)(g,[["render",_]]);var b=w},3723:function(e,t,a){a.r(t),a.d(t,{default:function(){return ye}});var l=a(3396),d=a(7139),i=a(9242);const n=e=>((0,l.dD)("data-v-7d587323"),e=e(),(0,l.Cn)(),e),s={class:"table mt-4"},r=n((()=>(0,l._)("thead",null,[(0,l._)("tr",null,[(0,l._)("th",null,"購買時間"),(0,l._)("th",{class:"rwd"},"Email"),(0,l._)("th",{class:"rwd"},"課程名稱"),(0,l._)("th",{class:"phone"},"課程資料"),(0,l._)("th",{class:"rwd"},"應付金額"),(0,l._)("th",{class:"rwd"},"是否付款"),(0,l._)("th",null,"編輯")])],-1))),o={class:"rwd"},c=["textContent"],u={class:"list-unstyled"},p={key:0,class:"phone"},h=n((()=>(0,l._)("br",null,null,-1))),_=n((()=>(0,l._)("br",null,null,-1))),g=n((()=>(0,l._)("br",null,null,-1))),m={class:"form-check form-switch phone"},w=["id","onUpdate:modelValue","onChange"],b=["for"],k={key:0},y={key:1},f={class:"text-right rwd"},v={class:"rwd"},D={class:"form-check form-switch"},O=["id","onUpdate:modelValue","onChange"],M=["for"],x={key:0},C={key:1},$={class:"btn-group"},z=["onClick"],P=["onClick"];function L(e,t,a,n,L,U){const q=(0,l.up)("LoadingView"),Z=(0,l.up)("OrderModal"),K=(0,l.up)("Pagination"),H=(0,l.up)("DeleteModal");return(0,l.wg)(),(0,l.iD)(l.HY,null,[(0,l.Wm)(q,{active:L.isLoading},null,8,["active"]),(0,l._)("table",s,[r,(0,l._)("tbody",null,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(L.orders,((t,a)=>((0,l.wg)(),(0,l.iD)(l.HY,{key:a},[L.orders.length?((0,l.wg)(),(0,l.iD)("tr",{key:0,class:(0,d.C_)({"text-secondary":!t.is_paid})},[(0,l._)("td",null,(0,d.zw)(e.$filters.date(t.create_at)),1),(0,l._)("td",o,[t.user?((0,l.wg)(),(0,l.iD)("span",{key:0,textContent:(0,d.zw)(t.user.email)},null,8,c)):(0,l.kq)("",!0)]),(0,l._)("td",null,[(0,l._)("ul",u,[t.user?((0,l.wg)(),(0,l.iD)("span",p,[(0,l.Uk)("信箱: "),h,(0,l.Uk)(" "+(0,d.zw)(t.user.email),1)])):(0,l.kq)("",!0),((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(t.products,((e,a)=>((0,l.wg)(),(0,l.iD)("li",{key:a},[(0,l.Uk)((0,d.zw)(e.product.engtitle)+" ",1),_,(0,l.Uk)(" 人數："+(0,d.zw)(e.qty)+" ",1),g,(0,l._)("div",m,[(0,l.wy)((0,l._)("input",{class:"form-check-input",type:"checkbox",id:`paidSwitch${t.id}`,"onUpdate:modelValue":e=>t.is_paid=e,onChange:e=>U.updatePaid(t)},null,40,w),[[i.e8,t.is_paid]]),(0,l._)("label",{class:"form-check-label",for:`paidSwitch${t.id}`},[t.is_paid?((0,l.wg)(),(0,l.iD)("span",k,"已付款")):((0,l.wg)(),(0,l.iD)("span",y,"未付款"))],8,b)])])))),128))])]),(0,l._)("td",f,(0,d.zw)(t.total),1),(0,l._)("td",v,[(0,l._)("div",D,[(0,l.wy)((0,l._)("input",{class:"form-check-input",type:"checkbox",id:`paidSwitch${t.id}`,"onUpdate:modelValue":e=>t.is_paid=e,onChange:e=>U.updatePaid(t)},null,40,O),[[i.e8,t.is_paid]]),(0,l._)("label",{class:"form-check-label",for:`paidSwitch${t.id}`},[t.is_paid?((0,l.wg)(),(0,l.iD)("span",x,"已付款")):((0,l.wg)(),(0,l.iD)("span",C,"未付款"))],8,M)])]),(0,l._)("td",null,[(0,l._)("div",$,[(0,l._)("button",{class:"btn btn-outline-primary btn-sm",onClick:e=>U.openModal(!1,t)}," 檢視 ",8,z),(0,l._)("button",{class:"btn btn-outline-danger btn-sm",onClick:e=>U.deleteModal(t)},"刪除",8,P)])])],2)):(0,l.kq)("",!0)],64)))),128))])]),(0,l.Wm)(Z,{order:L.tempOrder,ref:"OrderModal",onUpdateOrder:U.updatePaid},null,8,["order","onUpdateOrder"]),(0,l.Wm)(K,{pages:L.pagination,onChangePagination:U.getOrders},null,8,["pages","onChangePagination"]),(0,l.Wm)(H,{product:L.tempOrder,onDelItem:U.deleteOrder,ref:"DeleteModal"},null,8,["product","onDelItem"])],64)}const U={class:"modal fade",id:"productModal",tabindex:"-1",role:"dialog","aria-labelledby":"exampleModalLabel","aria-hidden":"true",ref:"modal"},q={class:"modal-dialog modal-xl",role:"document"},Z={class:"modal-content border-0"},K=(0,l._)("div",{class:"modal-header bg-dark text-white"},[(0,l._)("h5",{class:"modal-title",id:"exampleModalLabel"},[(0,l._)("span",null,"訂單細節")]),(0,l._)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),H={class:"modal-body"},Y={class:"row"},V={class:"col-md-4"},j=(0,l._)("h3",null,"用戶資料",-1),S={class:"table"},W={key:0},I=(0,l._)("th",{style:{width:"100px"}},"姓名",-1),E=(0,l._)("th",null,"Email",-1),N=(0,l._)("th",null,"電話",-1),A=(0,l._)("th",null,"地址",-1),B={class:"col-md-8"},F=(0,l._)("h3",null,"訂單細節",-1),G={class:"table"},J=(0,l._)("th",{style:{width:"100px"}},"訂單編號",-1),Q=(0,l._)("th",null,"下單時間",-1),R=(0,l._)("th",null,"付款時間",-1),T={key:0},X={key:1},ee=(0,l._)("th",null,"付款狀態",-1),te={key:0,class:"text-success"},ae={key:1,class:"text-muted"},le=(0,l._)("th",null,"總金額",-1),de=(0,l._)("h3",null,"選購商品",-1),ie={class:"table"},ne=(0,l._)("thead",null,[(0,l._)("tr")],-1),se={class:"text-end"},re={class:"modal-footer"},oe=(0,l._)("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"}," 取消 ",-1);function ce(e,t,a,i,n,s){return(0,l.wg)(),(0,l.iD)("div",U,[(0,l._)("div",q,[(0,l._)("div",Z,[K,(0,l._)("div",H,[(0,l._)("div",Y,[(0,l._)("div",V,[j,(0,l._)("table",S,[n.tempOrder.user?((0,l.wg)(),(0,l.iD)("tbody",W,[(0,l._)("tr",null,[I,(0,l._)("td",null,(0,d.zw)(n.tempOrder.user.name),1)]),(0,l._)("tr",null,[E,(0,l._)("td",null,(0,d.zw)(n.tempOrder.user.email),1)]),(0,l._)("tr",null,[N,(0,l._)("td",null,(0,d.zw)(n.tempOrder.user.tel),1)]),(0,l._)("tr",null,[A,(0,l._)("td",null,(0,d.zw)(n.tempOrder.user.address),1)])])):(0,l.kq)("",!0)])]),(0,l._)("div",B,[F,(0,l._)("table",G,[(0,l._)("tbody",null,[(0,l._)("tr",null,[J,(0,l._)("td",null,(0,d.zw)(n.tempOrder.id),1)]),(0,l._)("tr",null,[Q,(0,l._)("td",null,(0,d.zw)(e.$filters.date(n.tempOrder.create_at)),1)]),(0,l._)("tr",null,[R,(0,l._)("td",null,[n.tempOrder.paid_date?((0,l.wg)(),(0,l.iD)("span",T,(0,d.zw)(e.$filters.date(n.tempOrder.paid_date)),1)):((0,l.wg)(),(0,l.iD)("span",X,"時間不正確"))])]),(0,l._)("tr",null,[ee,(0,l._)("td",null,[n.tempOrder.is_paid?((0,l.wg)(),(0,l.iD)("strong",te,"已付款")):((0,l.wg)(),(0,l.iD)("span",ae,"尚未付款"))])]),(0,l._)("tr",null,[le,(0,l._)("td",null,(0,d.zw)(e.$filters.currency(n.tempOrder.total)),1)])])]),de,(0,l._)("table",ie,[ne,(0,l._)("tbody",null,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(n.tempOrder.products,(t=>((0,l.wg)(),(0,l.iD)("tr",{key:t.id},[(0,l._)("th",null,(0,d.zw)(t.product.title),1),(0,l._)("td",null,(0,d.zw)(t.qty)+" / "+(0,d.zw)(t.product.unit),1),(0,l._)("td",se,(0,d.zw)(e.$filters.currency(t.final_total)),1)])))),128))])])])])]),(0,l._)("div",re,[oe,(0,l._)("button",{type:"button",class:"btn btn-primary",onClick:t[0]||(t[0]=(...e)=>s.checkPaid&&s.checkPaid(...e))},"確認付款")])])])],512)}var ue=a(3618),pe={name:"orderModal",props:{order:{type:Object},default(){return{}}},methods:{checkPaid(){this.tempOrder.is_paid=!0,this.$emit("updateOrder",this.tempOrder)}},data(){return{tempOrder:{}}},emits:["updateOrder"],watch:{order(){this.tempOrder=this.order}},mixins:[ue.Z]},he=a(89);const _e=(0,he.Z)(pe,[["render",ce]]);var ge=_e,me=a(7064),we=a(8636),be={data(){return{orders:[],pagination:{},isLoading:!1,currentPage:1,tempOrder:{}}},components:{OrderModal:ge,DeleteModal:me.Z,Pagination:we.Z},methods:{getOrders(e=1){this.currentPage=e;const t=`https://vue3-course-api.hexschool.io/api/waynechendive-api/admin/orders?page=${e}`;this.isLoading=!0,this.$http.get(t).then((e=>{this.orders=e.data.orders,this.pagination=e.data.pagination,this.isLoading=!1}))},openModal(e,t){this.tempOrder=e?{}:{...t};const a=this.$refs.OrderModal;a.showModal()},deleteModal(e){this.tempOrder={...e};const t=this.$refs.DeleteModal;t.showModal()},deleteOrder(e){this.isLoading=!0,this.tempOrder=e;const t=`https://vue3-course-api.hexschool.io/api/waynechendive-api/admin/order/${this.tempOrder.id}`;this.$http.delete(t).then((e=>{const t=this.$refs.DeleteModal;this.getOrders(this.currentPage),this.isLoading=!1,t.hideModal(),this.$emitter.emit("push-msg",{style:"danger",title:e.data.message,content:e.data.message})})).catch((e=>{console.log(e)}))},updatePaid(e){this.isLoading=!0,this.tempOrder=e;const t=this.$refs.OrderModal,a=`https://vue3-course-api.hexschool.io/api/waynechendive-api/admin/order/${e.id}`,l={is_paid:e.is_paid};this.$http.put(a,{data:l}).then((e=>{this.isLoading=!1,t.hideModal(),e.data.success?(this.getOrders(this.currentPage),this.$emitter.emit("push-msg",{style:"success",title:e.data.message,content:e.data.message})):this.$emitter.emit("push-msg",{style:"warning",title:"更新失敗",content:e.data.message.join(",")})}))}},created(){this.getOrders()}};const ke=(0,he.Z)(be,[["render",L],["__scopeId","data-v-7d587323"]]);var ye=ke}}]);
//# sourceMappingURL=723.cd139846.js.map