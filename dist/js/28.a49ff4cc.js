"use strict";(self["webpackChunkDive"]=self["webpackChunkDive"]||[]).push([[28],{6028:function(e,t,a){a.r(t),a.d(t,{default:function(){return it}});var s=a(3396),l=a(9242),i=a(7139);const o={class:"container UserCarts"},d={class:"title mb-5"},n={"aria-label":"breadcrumb"},r={class:"breadcrumb"},c={class:"breadcrumb-item"},u=(0,s._)("li",{class:"breadcrumb-item active","aria-current":"page"},"購物車",-1),m=(0,s._)("hr",null,null,-1),p={class:"position-relative m-4"},b={class:"progress",style:{height:"5px"}},h={key:0,class:"progress-bar bg-titleblue",role:"progressbar",style:{width:"0%"},"aria-valuenow":"0","aria-valuemin":"0","aria-valuemax":"100"},_={key:1,class:"progress-bar bg-titleblue",role:"progressbar",style:{width:"33%"},"aria-valuenow":"33","aria-valuemin":"0","aria-valuemax":"100"},y=(0,s.uE)('<button type="button" class="position-absolute top-0 translate-middle btn btn-primary rounded-pill" style="left:0;"><i class="bi bi-cart2"></i></button><button type="button" class="position-absolute top-0 translate-middle btn btn-primary rounded-pill" style="left:33%;"><i class="bi bi-card-checklist"></i></button><button type="button" class="position-absolute top-0 translate-middle btn btn-primary rounded-pill" style="will-change:;left:66%;"><i class="bi bi-cash-coin"></i></button><button type="button" class="position-absolute top-0 translate-middle btn btn-secondary rounded-pill" style="left:100%;"><i class="bi bi-emoji-smile"></i></button>',4),v={class:"row"},g={class:"col-12 col-sm-8"},w=(0,s._)("div",{class:"rwd"},null,-1),f={class:"col-12 col-md-4"},k={key:0,class:"input-group mb-3 input-group-sm"},C={for:"coupon"},x={class:"input-group-append"},$=["disabled"],D=(0,s._)("span",{class:"mt-3 text-primary"},"迎接假期！輸入： happyvacation ，即享88折優惠",-1),q={key:1,class:"col-12 col-md-8 rounded mb-3"},V={class:"accordion w-100",id:"accordionExample"},U={class:"accordion-item"},L=(0,s._)("h2",{class:"accordion-header",id:"headingOne"},[(0,s._)("button",{class:"accordion-button",type:"button","data-bs-toggle":"collapse","data-bs-target":"#collapseOne","aria-expanded":"true","aria-controls":"collapseOne"}," 購物車品項 ")],-1),W={id:"collapseOne",class:"accordion-collapse collapse show","aria-labelledby":"headingOne","data-bs-parent":"#accordionExample"},z={class:"accordion-body"},O={class:"col-8"},E={class:"col-4 text-end"},j=(0,s._)("hr",null,null,-1),I={class:"row ms-1 pe-2"},R={class:"col-12 col-md-8 border rounded p-0"},F=(0,s._)("div",{class:"bg-bgblue rounded-top text-center text-textblue py-3"},[(0,s._)("h3",null,"訂單資料")],-1),H={class:"text-gray mx-3"},M={class:"text-end"},N={key:0,class:"mx-3"},P={class:"text-end"},Y={class:"text-danger mx-3"},Z={class:"text-end"},A={class:"text-end"},K=["disabled"];function S(e,t,a,S,T,X){const B=(0,s.up)("LoadingView"),G=(0,s.up)("router-link"),J=(0,s.up)("CartsItem"),Q=(0,s.up)("CartsForm");return(0,s.wg)(),(0,s.iD)(s.HY,null,[(0,s.Wm)(B,{active:T.isLoading},null,8,["active"]),(0,s._)("div",o,[(0,s._)("div",d,[(0,s._)("nav",n,[(0,s._)("ol",r,[(0,s._)("li",c,[(0,s.Wm)(G,{class:"text-decoration-none",to:"/home"},{default:(0,s.w5)((()=>[(0,s.Uk)("首頁")])),_:1})]),u])]),m,(0,s._)("div",p,[(0,s._)("div",b,[T.sendData?(0,s.kq)("",!0):((0,s.wg)(),(0,s.iD)("div",h)),T.sendData?((0,s.wg)(),(0,s.iD)("div",_)):(0,s.kq)("",!0)]),y])]),(0,s._)("div",v,[(0,s._)("div",g,[T.sendData?(0,s.kq)("",!0):((0,s.wg)(),(0,s.j4)(J,{key:0,data:T.carts,onReduceCart:X.reduceCart,onAddCart:X.addCart,onRemoveCart:X.removeCartItem,onDeleCart:X.deleteCart},null,8,["data","onReduceCart","onAddCart","onRemoveCart","onDeleCart"])),w]),(0,s._)("div",f,[T.sendData?(0,s.kq)("",!0):((0,s.wg)(),(0,s.iD)("div",k,[(0,s._)("label",C,[(0,s.wy)((0,s._)("input",{type:"text",class:"form-control","onUpdate:modelValue":t[0]||(t[0]=e=>T.coupon_code=e),placeholder:"請輸入優惠碼"},null,512),[[l.nr,T.coupon_code]])]),(0,s._)("div",x,[(0,s._)("button",{disabled:T.carts.length<1,class:"btn btn-outline-secondary",type:"button",onClick:t[1]||(t[1]=(...e)=>X.addCouponCode&&X.addCouponCode(...e))}," 套用優惠碼 ",8,$)]),D])),T.sendData?((0,s.wg)(),(0,s.iD)("div",q,[(0,s._)("div",V,[(0,s._)("div",U,[L,(0,s._)("div",W,[(0,s._)("div",z,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(T.carts,(e=>((0,s.wg)(),(0,s.iD)("div",{class:"row",key:e.id},[(0,s._)("div",O,(0,i.zw)(e.product.title),1),(0,s._)("div",E,"X"+(0,i.zw)(e.qty),1),j])))),128))])])])])])):(0,s.kq)("",!0),(0,s._)("div",I,[(0,s._)("div",R,[F,(0,s._)("div",H,[(0,s.Uk)(" 商品金額: "),(0,s._)("p",M,"$"+(0,i.zw)(this.$filters.currency(T.price.total)),1)]),T.price.total!=T.price.final_total?((0,s.wg)(),(0,s.iD)("div",N,[(0,s.Uk)(" 折扣金額: "),(0,s._)("p",P,"$"+(0,i.zw)(this.$filters.currency(T.price.total-T.price.final_total)),1)])):(0,s.kq)("",!0),(0,s._)("div",Y,[(0,s.Uk)(" 總金額: "),(0,s._)("p",Z,"$"+(0,i.zw)(this.$filters.currency(T.price.final_total)),1)]),(0,s._)("div",A,[T.sendData?(0,s.kq)("",!0):((0,s.wg)(),(0,s.iD)("button",{key:0,class:"btn btn-outline-secondary mb-3",type:"button",disabled:T.carts.length<1,onClick:t[2]||(t[2]=e=>T.sendData=!0)}," 送出資料 ",8,K))])])]),T.isMounted?((0,s.wg)(),(0,s.j4)(s.lR,{key:2,to:".rwd",class:"imgtp",disabled:T.isDisabled},[T.sendData?((0,s.wg)(),(0,s.j4)(Q,{key:0})):(0,s.kq)("",!0)],8,["disabled"])):(0,s.kq)("",!0)])])])],64)}const T={class:"row"},X={class:"border"},B={key:0,class:"container mt-4"},G={class:"table table-hover align-middle align-middle"},J=(0,s._)("thead",null,[(0,s._)("tr",{class:"align-middle text-sm text-gray-400"},[(0,s._)("th",{scope:"col",style:{width:"52%"}},"購物車"),(0,s._)("th",{scope:"col",class:"d-none d-md-table-cell",style:{width:"23%"}},"人數"),(0,s._)("th",{scope:"col",class:"d-none d-md-table-cell",style:{width:"15%"}},"總計"),(0,s._)("th",{scope:"col",class:"d-none d-md-table-cell text-center",style:{width:"10%"}}," 刪除 ")])],-1),Q={class:"d-flex align-items-center flex-column flex-sm-row"},ee={class:"d-md-none p-2"},te=["onClick"],ae=(0,s._)("i",{class:"bi bi-trash"},null,-1),se=[ae],le=["src","alt","title"],ie={class:"text-start py-4"},oe={class:"h5 fw-bolder"},de={class:"d-md-none"},ne={class:"py-2"},re={class:"input-group"},ce=["onClick","disabled"],ue=(0,s._)("i",{class:"bi bi-dash"},null,-1),me=[ue],pe=["onUpdate:modelValue"],be=["onClick","disabled"],he=(0,s._)("i",{class:"bi bi-plus"},null,-1),_e=[he],ye={class:"d-none d-md-table-cell text-end align-middle"},ve={class:"input-group"},ge=["onClick","disabled"],we=(0,s._)("i",{class:"bi bi-dash"},null,-1),fe=[we],ke=["onUpdate:modelValue"],Ce=["onClick","disabled"],xe=(0,s._)("i",{class:"bi bi-plus"},null,-1),$e=[xe],De={class:"d-none d-md-table-cell text-end h5"},qe={class:"d-none d-md-table-cell text-end"},Ve=["onClick"],Ue=(0,s._)("i",{class:"bi bi-trash"},null,-1),Le=[Ue],We={key:1,class:"container-fluid mt-4"},ze={class:"text-center"},Oe=(0,s._)("i",{class:"bi bi-cart4 display-1 fw-bold text-dark"},null,-1),Ee=(0,s._)("h3",{class:"p-3"},"目前購物車還沒有商品唷",-1);function je(e,t,a,o,d,n){const r=(0,s.up)("router-link");return(0,s.wg)(),(0,s.iD)(s.HY,null,[(0,s._)("button",{class:"btn btn-outline-secondary mb-3",type:"button",onClick:t[0]||(t[0]=t=>e.$emit("deleCart"))}," 清空資料 "),(0,s._)("div",T,[(0,s._)("div",X,[d.carts.length>0?((0,s.wg)(),(0,s.iD)("div",B,[(0,s._)("table",G,[J,(0,s._)("tbody",null,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(d.carts,(t=>((0,s.wg)(),(0,s.iD)("tr",{key:t.id},[(0,s._)("td",Q,[(0,s._)("div",ee,[(0,s._)("button",{type:"button",class:"btn d-md-block mx-auto btnClose",onClick:a=>e.$emit("removeCart",t.id)},se,8,te)]),(0,s._)("img",{class:"productImg w-50 p-1",src:t.product.imageUrl,alt:t.product.title,title:t.product.title},null,8,le),(0,s._)("div",ie,[(0,s._)("div",oe,(0,i.zw)(t.product.title),1),(0,s._)("div",de,[(0,s._)("div",ne,"NT$"+(0,i.zw)(e.$filters.currency(t.total)),1),(0,s._)("div",re,[(0,s._)("button",{type:"button",class:"btn btn-outline-dark",onClick:a=>e.$emit("reduceCart",t),disabled:1==t.qty},me,8,ce),(0,s.wy)((0,s._)("input",{id:"num1",type:"text",min:"1","onUpdate:modelValue":e=>t.qty=e,class:"form-control text-center border-dark bg-transparent",readonly:""},null,8,pe),[[l.nr,t.qty,void 0,{number:!0}]]),(0,s._)("button",{type:"button",class:"btn btn-outline-dark",onClick:a=>e.$emit("addCart",t),disabled:4==t.qty},_e,8,be)])])])]),(0,s._)("td",ye,[(0,s._)("div",ve,[(0,s._)("button",{type:"button",class:"btn btn-outline-dark",onClick:a=>e.$emit("reduceCart",t),disabled:1==t.qty},fe,8,ge),(0,s.wy)((0,s._)("input",{id:"num",type:"text",min:"1","onUpdate:modelValue":e=>t.qty=e,class:"form-control form-control-sm text-center border-dark",readonly:""},null,8,ke),[[l.nr,t.qty,void 0,{number:!0}]]),(0,s._)("button",{type:"button",class:"btn btn-outline-dark",onClick:a=>e.$emit("addCart",t),disabled:4===t.qty},$e,8,Ce)])]),(0,s._)("td",De," NT$"+(0,i.zw)(e.$filters.currency(t.total)),1),(0,s._)("td",qe,[(0,s._)("button",{type:"button",class:"btn d-md-block mx-auto btnClose",onClick:a=>e.$emit("removeCart",t.id)},Le,8,Ve)])])))),128))])])])):((0,s.wg)(),(0,s.iD)("div",We,[(0,s._)("div",ze,[Oe,Ee,(0,s.Wm)(r,{to:"/UserProducts",class:"btn btn-outline-dark btn-lg mb-5"},{default:(0,s.w5)((()=>[(0,s.Uk)("選購商品")])),_:1})])]))])])],64)}var Ie={data(){return{carts:[]}},props:{data:{type:Object},default(){return{}}},emits:["deleCart","addCart","removeCart","reduceCart"],watch:{data(){this.carts=this.data}}},Re=a(89);const Fe=(0,Re.Z)(Ie,[["render",je]]);var He=Fe;const Me={class:"row justify-content-center p-md-0 p-3"},Ne=(0,s._)("h3",{class:"text-center fs-3"},"顧客聯絡資料",-1),Pe={class:"my-3"},Ye=(0,s._)("label",{for:"name",class:"form-label"},"聯絡人姓名",-1),Ze={class:"mb-3"},Ae=(0,s._)("label",{for:"email",class:"form-label"},"聯絡人Email",-1),Ke={class:"mb-3"},Se=(0,s._)("label",{for:"tel",class:"form-label"},"聯絡人電話",-1),Te={class:"mb-3"},Xe=(0,s._)("label",{for:"address",class:"form-label"},"聯絡人地址",-1),Be={class:"mb-3"},Ge=(0,s._)("label",{for:"message",class:"form-label"},"留言",-1),Je=(0,s._)("div",{class:"text-end mb-3"},[(0,s._)("button",{class:"btn btn-danger"},"送出資料")],-1);function Qe(e,t,a,o,d,n){const r=(0,s.up)("FieldView"),c=(0,s.up)("ErrorMessage"),u=(0,s.up)("FormView");return(0,s.wg)(),(0,s.iD)("div",Me,[Ne,(0,s.Wm)(u,{class:"col-md-10 bg-titleblue rounded my-3 text-warning",onSubmit:n.createOrder},{default:(0,s.w5)((({errors:e})=>[(0,s._)("div",Pe,[Ye,(0,s.Wm)(r,{id:"name",name:"姓名",type:"text",class:(0,i.C_)(["form-control",{"is-invalid":e["姓名"],"is-valid":!e[0]&&""!=d.form.user.name}]),placeholder:"請輸入聯絡人姓名",rules:n.isName,modelValue:d.form.user.name,"onUpdate:modelValue":t[0]||(t[0]=e=>d.form.user.name=e)},null,8,["class","rules","modelValue"]),(0,s.Wm)(c,{name:"姓名",class:"invalid-feedback"})]),(0,s._)("div",Ze,[Ae,(0,s.Wm)(r,{id:"email",name:"email",type:"email",class:(0,i.C_)(["form-control",{"is-invalid":e["email"],"is-valid":!e[0]&&""!=d.form.user.email}]),placeholder:"請輸入聯絡人Email",rules:"email|required",modelValue:d.form.user.email,"onUpdate:modelValue":t[1]||(t[1]=e=>d.form.user.email=e)},null,8,["class","modelValue"]),(0,s.Wm)(c,{name:"email",class:"invalid-feedback"})]),(0,s._)("div",Ke,[Se,(0,s.Wm)(r,{id:"tel",name:"電話",type:"tel",class:(0,i.C_)(["form-control",{"is-invalid":e["電話"],"is-valid":!e[0]&&""!=d.form.user.tel}]),placeholder:"請輸入聯絡人電話",rules:n.isPhone,modelValue:d.form.user.tel,"onUpdate:modelValue":t[2]||(t[2]=e=>d.form.user.tel=e)},null,8,["class","rules","modelValue"]),(0,s.Wm)(c,{name:"電話",class:"invalid-feedback"})]),(0,s._)("div",Te,[Xe,(0,s.Wm)(r,{id:"address",name:"地址",type:"text",class:(0,i.C_)(["form-control",{"is-invalid":e["地址"],"is-valid":!e[0]&&""!=d.form.user.address}]),placeholder:"請輸入聯絡人地址",rules:"required",modelValue:d.form.user.address,"onUpdate:modelValue":t[3]||(t[3]=e=>d.form.user.address=e)},null,8,["class","modelValue"]),(0,s.Wm)(c,{name:"地址",class:"invalid-feedback"})]),(0,s._)("div",Be,[Ge,(0,s.wy)((0,s._)("textarea",{name:"",id:"message",class:"form-control",cols:"30",rows:"10","onUpdate:modelValue":t[4]||(t[4]=e=>d.form.message=e)},null,512),[[l.nr,d.form.message]])]),Je])),_:1},8,["onSubmit"])])}a(7658);var et={data(){return{form:{user:{name:"",email:"",tel:"",address:""},message:""}}},methods:{isName(e){const t=/^[\u4e00-\u9fa5A-Za-z]{0,}$/;return""===this.form.user.name?"姓名為必填":!!t.test(e)||"需要中文或英文姓名"},isPhone(e){const t=/^(09)[0-9]{8}$/;return""===this.form.user.tel?"電話為必填":!!t.test(e)||"需要正確的電話號碼"},createOrder(){const e="https://vue3-course-api.hexschool.io/api/waynechendive-api/order",t=this.form;this.$http.post(e,{data:t}).then((e=>{this.$emitter.emit("push-cart",{style:"success",title:e.data.message,content:e.data.message}),this.$router.push(`/Order/PayView/${e.data.orderId}`)}))}}};const tt=(0,Re.Z)(et,[["render",Qe]]);var at=tt,st={data(){return{carts:[],price:{},coupon_code:"",sendData:!1,isload:!1,isLoading:!1,isMounted:!1,isDisabled:!1}},components:{CartsItem:He,CartsForm:at},mounted(){this.isMounted=!0,window.innerWidth<430&&(this.isDisabled=!0),window.addEventListener("resize",(()=>{console.log(window.screen.width),window.innerWidth<430?this.isDisabled=!0:this.isDisabled=!1})),this.$emitter.on("push-cart",(()=>{this.getusercarts()}))},methods:{reduceCart(e){this.isLoad=!0;const t=`https://vue3-course-api.hexschool.io/api/waynechendive-api/cart/${e.id}`,a={product_id:e.product_id,qty:e.qty-1};this.$http.put(t,{data:a}).then((e=>{this.$emitter.emit("push-cart",{style:"warning",title:e.data.message,content:e.data.message}),this.isLoad=!1,this.getusercarts()}))},addCart(e){this.isLoad=!0;const t=`https://vue3-course-api.hexschool.io/api/waynechendive-api/cart/${e.id}`,a={product_id:e.product_id,qty:e.qty+1};this.$http.put(t,{data:a}).then((e=>{this.$emitter.emit("push-cart",{style:"success",title:e.data.message,content:e.data.message}),this.isLoad=!1,this.getusercarts()}))},removeCartItem(e){const t=`https://vue3-course-api.hexschool.io/api/waynechendive-api/cart/${e}`;this.$http.delete(t).then((e=>{this.$emitter.emit("push-cart",{style:"warning",title:e.data.message,content:e.data.message}),this.getusercarts()}))},deleteCart(){this.isLoading=!0;const e="https://vue3-course-api.hexschool.io/api/waynechendive-api/carts";this.$http.delete(e).then((e=>{this.isLoading=!1,this.$emitter.emit("push-cart",{style:"danger",title:e.data.message,content:e.data.message}),this.getusercarts()}))},addCouponCode(){const e="https://vue3-course-api.hexschool.io/api/waynechendive-api/coupon",t={code:this.coupon_code};this.isLoading=!0,this.$http.post(e,{data:t}).then((e=>{this.$emitter.emit("push-cart",{style:"info",title:e.data.message,content:e.data.message}),this.getusercarts(),this.isLoading=!1}))},getusercarts(){this.isLoading=!0;const e="https://vue3-course-api.hexschool.io/api/waynechendive-api/cart";this.$http.get(e).then((e=>{this.price=e.data.data,this.carts=e.data.data.carts,this.isLoading=!1})).catch((e=>{console.log(e)}))}},created(){this.getusercarts()}};const lt=(0,Re.Z)(st,[["render",S]]);var it=lt}}]);
//# sourceMappingURL=28.a49ff4cc.js.map